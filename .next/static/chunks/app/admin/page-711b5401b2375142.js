(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{1517:(e,t,r)=>{"use strict";r.d(t,{AppBrand:()=>n});var a=r(5155),s=r(2619),l=r.n(s),o=r(6979);function n(e){let{href:t="/",textClassName:r="text-2xl font-bold",logoClassName:s=""}=e,n=(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(o.v,{className:"border border-white/30 bg-white/10 text-white/60 ".concat(s)}),(0,a.jsx)("span",{className:r,children:"Performance Tool"})]});return t?(0,a.jsx)(l(),{href:t,className:"flex items-center gap-3",children:n}):n}},6979:(e,t,r)=>{"use strict";r.d(t,{v:()=>o});var a=r(5155),s=r(5239),l=r(2115);function o(e){let{size:t=36,className:r="",imgClassName:o=""}=e,[n,i]=(0,l.useState)(null);return(0,l.useEffect)(()=>{let e=!0;return(async()=>{try{let t=await fetch("/api/app-logo");if(!t.ok)return;let r=await t.json();e&&i(r.logoUrl||null)}catch(e){}})(),()=>{e=!1}},[]),(0,a.jsx)("div",{className:"flex items-center justify-center overflow-hidden ".concat(r),style:{width:t,height:t,borderRadius:8},children:n?(0,a.jsx)(s.default,{src:n,alt:"App logo",width:t,height:t,unoptimized:!0,className:"max-w-full max-h-full object-contain ".concat(o)}):(0,a.jsx)("span",{className:"text-[10px] font-semibold uppercase tracking-wide",children:"Logo"})})}},7930:(e,t,r)=>{Promise.resolve().then(r.bind(r,8364))},8364:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var a=r(5155),s=r(2115),l=r(2619),o=r.n(l),n=r(9815);function i(e){let{onSubmit:t,isLoading:r=!1}=e,l="America/New_York",[o,n]=(0,s.useState)([{title:"",description:"",date:"",location:"",call_time:"",timezone:l,rehearsals:[]}]),[i,c]=(0,s.useState)(null),d=(e,t,r)=>{n(a=>a.map((a,s)=>s===e?{...a,[t]:r}:a))},m=(e,t,r,a)=>{n(s=>s.map((s,l)=>l===e?{...s,rehearsals:s.rehearsals.map((e,s)=>s===t?{...e,[r]:a}:e)}:s))},x=async e=>{e.preventDefault(),c(null);let r=o.findIndex(e=>!e.title||!e.date||!e.location);if(-1!==r)return void c("Please fill in all required fields for performance #".concat(r+1));try{await t(o),n([{title:"",description:"",date:"",location:"",call_time:"",timezone:l,rehearsals:[]}])}catch(e){c(e instanceof Error?e.message:"An error occurred")}};return(0,a.jsxs)("form",{onSubmit:x,className:"space-y-4",children:[i&&(0,a.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:[(0,a.jsxs)("p",{className:"font-semibold",children:["Error: ",i]}),i.includes("supabaseUrl")&&(0,a.jsx)("p",{className:"text-sm mt-2",children:"\uD83D\uDCCC Make sure to configure your .env.local file with Supabase credentials. See QUICK_START.md for instructions."})]}),o.map((e,t)=>(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 bg-white space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("h3",{className:"font-semibold text-gray-900",children:["Performance #",t+1]}),o.length>1&&(0,a.jsx)("button",{type:"button",onClick:()=>{n(e=>e.filter((e,r)=>r!==t))},className:"text-sm text-red-600 hover:text-red-800",children:"Remove"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Performance Title *"}),(0,a.jsx)("input",{type:"text",value:e.title,onChange:e=>d(t,"title",e.target.value),placeholder:"e.g., Spring Recital 2026",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Time *"}),(0,a.jsx)("input",{type:"datetime-local",value:e.date,onChange:e=>d(t,"date",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Call Time"}),(0,a.jsx)("input",{type:"time",value:e.call_time,onChange:e=>d(t,"call_time",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Location *"}),(0,a.jsx)("input",{type:"text",value:e.location,onChange:e=>d(t,"location",e.target.value),placeholder:"e.g., Main Auditorium",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["Timezone: ",e.timezone]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Notes"}),(0,a.jsx)("textarea",{value:e.description,onChange:e=>d(t,"description",e.target.value),placeholder:"Add any details about this performance...",rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{className:"border-t border-gray-200 pt-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("div",{className:"font-semibold text-gray-900",children:"Rehearsals (optional)"}),(0,a.jsx)("button",{type:"button",onClick:()=>{n(e=>e.map((e,r)=>r===t?{...e,rehearsals:[...e.rehearsals,{title:"",date:"",time:"",location:""}]}:e))},className:"text-xs text-blue-700 hover:text-blue-900",children:"+ Add rehearsal"})]}),0===e.rehearsals.length&&(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"No rehearsals added."}),(0,a.jsx)("div",{className:"space-y-3",children:e.rehearsals.map((e,r)=>(0,a.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-200",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2",children:[(0,a.jsx)("input",{type:"text",value:e.title,onChange:e=>m(t,r,"title",e.target.value),placeholder:"Rehearsal title",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"}),(0,a.jsx)("input",{type:"date",value:e.date,onChange:e=>m(t,r,"date",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"}),(0,a.jsx)("input",{type:"time",value:e.time,onChange:e=>m(t,r,"time",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"}),(0,a.jsx)("input",{type:"text",value:e.location,onChange:e=>m(t,r,"location",e.target.value),placeholder:"Location",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),(0,a.jsx)("button",{type:"button",onClick:()=>{n(e=>e.map((e,a)=>a===t?{...e,rehearsals:e.rehearsals.filter((e,t)=>t!==r)}:e))},className:"mt-2 text-xs text-red-600 hover:text-red-800",children:"Remove rehearsal"})]},"reh-".concat(t,"-").concat(r)))})]})]},"performance-".concat(t))),(0,a.jsx)("button",{type:"button",onClick:()=>{n(e=>[...e,{title:"",description:"",date:"",location:"",call_time:"",timezone:l,rehearsals:[]}])},className:"w-full px-4 py-2 bg-gray-200 text-gray-900 rounded-lg hover:bg-gray-300 font-medium",children:"+ Add Another Performance"}),(0,a.jsx)("button",{type:"submit",disabled:r,className:"w-full px-6 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 disabled:bg-gray-400 transition-colors",children:r?"Creating...":"Create Performance"})]})}function c(e){let{performances:t,onDelete:r,isLoading:s=!1}=e;return 0===t.length?(0,a.jsxs)("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"No performances created yet."}),(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:"Create your first performance to get started!"})]}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-200",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-2 text-left",children:"Title"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left",children:"Date"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left",children:"Location"}),(0,a.jsx)("th",{className:"px-4 py-2 text-center",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:t.map(e=>(0,a.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-4 py-3 font-semibold",children:e.title}),(0,a.jsx)("td",{className:"px-4 py-3",children:((e,t)=>{if(!e)return"--";let r=new Date(e);return Number.isNaN(r.getTime())?"--":r.toLocaleString(void 0,{timeZone:t||"America/New_York",timeZoneName:"short"})})(e.date,e.timezone)}),(0,a.jsx)("td",{className:"px-4 py-3",children:e.location}),(0,a.jsxs)("td",{className:"px-4 py-3 text-center space-x-2",children:[(0,a.jsx)(o(),{href:"/admin/performances/".concat(e.id),className:"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm",children:"Manage"}),(0,a.jsx)("button",{onClick:()=>{window.confirm("Are you sure you want to delete this performance?")&&r(e.id)},disabled:s,className:"px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 text-sm disabled:bg-gray-400",children:"Delete"})]})]},e.id))})]})})}var d=r(5239);function m(){let[e,t]=(0,s.useState)(!1),[r,l]=(0,s.useState)(null),[o,n]=(0,s.useState)(!1),[i,c]=(0,s.useState)(null),[m,x]=(0,s.useState)(null);(0,s.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/app-logo");if(!e.ok)return;let t=await e.json();c(t.logoUrl||null),x(t.logoFileName||null)}catch(e){}})()},[]);let u=async e=>{var r;let a=null==(r=e.currentTarget.files)?void 0:r[0];if(a){t(!0),l(null),n(!1);try{let t=new FormData;t.append("file",a);let r=await fetch("/api/app-logo",{method:"POST",body:t});if(!r.ok){let e=await r.json();throw Error(e.error||"Upload failed")}let s=await r.json();c(s.logoUrl||null),x(s.logoFileName||null),n(!0),e.currentTarget.value=""}catch(e){l(e instanceof Error?e.message:"Upload failed")}finally{t(!1)}}};return(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[(0,a.jsx)("h3",{className:"font-bold text-lg text-gray-900 mb-4",children:"App Logo"}),i&&(0,a.jsxs)("div",{className:"mb-4 flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-16 h-16 rounded-lg border border-gray-200 bg-white flex items-center justify-center overflow-hidden",children:(0,a.jsx)(d.default,{src:i,alt:"App logo preview",width:64,height:64,unoptimized:!0,className:"max-w-full max-h-full object-contain"})}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,a.jsx)("div",{className:"font-semibold text-gray-900",children:"Current Logo"}),(0,a.jsx)("div",{children:m||"Uploaded logo"})]})]}),!i&&(0,a.jsx)("div",{className:"mb-4 text-sm text-gray-600",children:"No logo uploaded yet. Upload one to display it across the app and exports."}),(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("div",{className:"flex items-center justify-center w-full p-6 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-blue-400 transition-colors bg-gray-50 hover:bg-blue-50",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-2xl mb-2",children:"\uD83D\uDDBC️"}),(0,a.jsx)("p",{className:"text-sm font-semibold text-gray-700",children:e?"Uploading...":"Click to upload logo"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"PNG, JPG, SVG, WebP (max 5MB)"})]})}),(0,a.jsx)("input",{type:"file",accept:"image/*",onChange:u,disabled:e,className:"hidden"})]}),r&&(0,a.jsx)("div",{className:"mt-3 p-3 bg-red-50 border border-red-200 rounded",children:(0,a.jsxs)("p",{className:"text-sm text-red-900",children:["❌ ",r]})}),o&&(0,a.jsx)("div",{className:"mt-3 p-3 bg-green-50 border border-green-200 rounded",children:(0,a.jsx)("p",{className:"text-sm text-green-900",children:"✅ Logo uploaded successfully!"})})]})}var x=r(1517);function u(){let[e,t]=(0,s.useState)("performances"),[r,l]=(0,s.useState)(!1),{performances:i,loading:c,createPerformance:d,deletePerformance:u}=(0,n.f)(),p=async e=>{for(let t of e){let e=await d(t.title,t.description,t.date?new Date(t.date).toISOString():t.date,t.location,t.call_time,t.timezone||"America/New_York");for(let r of(t.rehearsals||[]).filter(e=>e.date&&e.time&&e.location))await fetch("/api/rehearsals",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({performance_id:e.id,title:r.title||"".concat(t.title," Rehearsal"),date:r.date,time:r.time,location:r.location})})}l(!1)};return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,a.jsx)("nav",{className:"bg-blue-900 text-white p-4 shadow-lg",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto flex justify-between items-center",children:[(0,a.jsx)(x.AppBrand,{href:"/"}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)(o(),{href:"/",className:"hover:bg-blue-800 px-3 py-2 rounded",children:"Home"}),(0,a.jsx)("span",{className:"px-3 py-2 bg-blue-800 rounded",children:"Admin Panel"})]})]})}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto p-6",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Admin Dashboard"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Manage performances, rehearsals, parts, and stage positioning"})]}),(0,a.jsx)("div",{className:"mb-8",children:(0,a.jsx)(m,{})}),(0,a.jsx)("div",{className:"flex gap-4 mb-8 flex-wrap",children:(0,a.jsx)("button",{onClick:()=>t("performances"),className:"px-6 py-3 rounded-lg font-semibold transition-colors ".concat("performances"===e?"bg-blue-600 text-white":"bg-white text-gray-900 hover:bg-gray-50"),children:"Performances"})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-md p-8",children:"performances"===e&&(0,a.jsx)(h,{performances:i,loading:c,showForm:r,onToggleForm:()=>l(!r),onCreatePerformance:p,onDeletePerformance:u})})]})]})}function h(e){let{performances:t,loading:r,showForm:s,onToggleForm:l,onCreatePerformance:o,onDeletePerformance:n}=e;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold",children:"Performances"}),(0,a.jsx)("button",{onClick:l,className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-semibold",children:s?"Cancel":"+ Create New Performance"})]}),s&&(0,a.jsx)("div",{className:"mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200",children:(0,a.jsx)(i,{onSubmit:o})}),r?(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("p",{className:"text-gray-600",children:"Loading performances..."})}):(0,a.jsx)(c,{performances:t,onDelete:n})]})}},9815:(e,t,r)=>{"use strict";r.d(t,{f:()=>s});var a=r(2115);function s(){let[e,t]=(0,a.useState)([]),[r,s]=(0,a.useState)(!0),[l,o]=(0,a.useState)(null);(0,a.useEffect)(()=>{!async function(){try{let e=await fetch("/api/performances");if(!e.ok)throw Error("Failed to fetch performances");let r=await e.json();t(r)}catch(e){o(e instanceof Error?e.message:"An error occurred")}finally{s(!1)}}()},[]);let n=async(r,a,s,l,n,i)=>{try{let o=await fetch("/api/performances",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:r,description:a,date:s,location:l,call_time:n,timezone:i})});if(!o.ok)throw Error("Failed to create performance");let c=await o.json();return t([...e,c]),c}catch(e){throw o(e instanceof Error?e.message:"An error occurred"),e}},i=async r=>{try{if(!(await fetch("/api/performances/".concat(r),{method:"DELETE"})).ok)throw Error("Failed to delete performance");t(e.filter(e=>e.id!==r))}catch(e){throw o(e instanceof Error?e.message:"An error occurred"),e}};return{performances:e,loading:r,error:l,createPerformance:n,deletePerformance:i}}}},e=>{e.O(0,[481,441,255,358],()=>e(e.s=7930)),_N_E=e.O()}]);