(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3698],{701:(e,t,a)=>{"use strict";a.d(t,{e:()=>o});var r=a(5155),l=a(2115);let s=null;var n=a(5704);function o(e){let{value:t,onChange:a,placeholder:o,className:i,disabled:d=!1}=e,c=(0,l.useRef)(null),[m,u]=(0,l.useState)(null);return(0,l.useEffect)(()=>{var e,t;let r=n.env.NEXT_PUBLIC_GOOGLE_PLACES_API_KEY||"";if(!r||!c.current)return;let l=null;return((null==(t=window.google)||null==(e=t.maps)?void 0:e.places)?Promise.resolve():s||(s=new Promise((e,t)=>{let a=document.querySelector("script[data-google-places]");if(a){a.addEventListener("load",()=>e()),a.addEventListener("error",()=>t(Error("Failed to load Google Places")));return}let l=document.createElement("script");l.src="https://maps.googleapis.com/maps/api/js?key=".concat(r,"&libraries=places"),l.async=!0,l.defer=!0,l.dataset.googlePlaces="true",l.onload=()=>e(),l.onerror=()=>t(Error("Failed to load Google Places")),document.head.appendChild(l)}))).then(()=>{if(!c.current)return;let e=new window.google.maps.places.Autocomplete(c.current,{types:["geocode"],fields:["formatted_address","name"]});l=e,e.addListener("place_changed",()=>{let t=e.getPlace(),r=(null==t?void 0:t.formatted_address)||(null==t?void 0:t.name)||"";r&&a(r)})}).catch(e=>{u(e instanceof Error?e.message:"Failed to load Google Places")}),()=>{l&&window.google.maps.event.clearInstanceListeners(l)}},[a]),(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{ref:c,type:"text",value:t,onChange:e=>a(e.target.value),placeholder:o,className:i,disabled:d}),m&&(0,r.jsx)("div",{className:"text-xs text-amber-700 mt-1",children:"Location autocomplete unavailable."})]})}},2890:(e,t,a)=>{"use strict";a.d(t,{N:()=>r});let r=(0,a(2373).UU)("https://quqvudqzztlmgrwqudho.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InF1cXZ1ZHF6enRsbWdyd3F1ZGhvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg0MzQ1NjQsImV4cCI6MjA4NDAxMDU2NH0.NwxDWyz7vQiM1r3SqMn62iLjBJQGEO1-K6qgsP74hYg")},2992:(e,t,a)=>{"use strict";function r(e){try{let t=window.localStorage.getItem(e);if(!t)return null;return JSON.parse(t)}catch(e){return null}}function l(e,t){try{window.localStorage.setItem(e,JSON.stringify(t))}catch(e){}}function s(e){try{window.localStorage.removeItem(e)}catch(e){}}a.d(t,{C_:()=>r,J1:()=>l,nr:()=>s})},5959:(e,t,a)=>{"use strict";a.d(t,{$:()=>n});var r=a(5155),l=a(2115),s=a(2890);function n(e){let{className:t}=e,[a,n]=(0,l.useState)(!1);return(0,r.jsx)("button",{onClick:async()=>{n(!0),await s.N.auth.signOut(),n(!1)},disabled:a,className:t,children:a?"Signing out...":"Sign Out"})}},7930:(e,t,a)=>{Promise.resolve().then(a.bind(a,8364))},8364:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>f});var r=a(5155),l=a(2115),s=a(2619),n=a.n(s),o=a(9815),i=a(701),d=a(2992),c=a(9157);function m(e){let{onSubmit:t,isLoading:a=!1}=e,s="America/New_York",n="rehearse:performance-form",[o,m]=(0,l.useState)(!1),[u,x]=(0,l.useState)(null),[g,h]=(0,l.useState)([{title:"",description:"",date:"",location:"",call_time:"",call_time_manual:!1,timezone:s,rehearsals:[]}]),[p,b]=(0,l.useState)(null),f=(0,l.useRef)(null);(0,l.useEffect)(()=>{var e;let t=(0,d.C_)(n);(null==t||null==(e=t.entries)?void 0:e.length)&&(h(t.entries),m(!0),x(t.savedAt||null))},[]),(0,l.useEffect)(()=>(f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{let e=new Date().toISOString();(0,d.J1)(n,{entries:g,savedAt:e}),x(e)},400),()=>{f.current&&clearTimeout(f.current)}),[g]);let y=(e,t,a)=>{h(r=>r.map((r,l)=>{if(l!==e)return r;let s={...r,[t]:a};return"call_time"===t&&(s.call_time_manual=!0),"date"!==t||r.call_time_manual||(s.call_time=(0,c.Kb)(a)),s}))},j=(e,t,a,r)=>{h(l=>l.map((l,s)=>s===e?{...l,rehearsals:l.rehearsals.map((e,l)=>l===t?{...e,[a]:r}:e)}:l))},N=async e=>{e.preventDefault(),b(null);let a=g.findIndex(e=>!e.title||!e.date||!e.location);if(-1!==a)return void b("Please fill in all required fields for performance #".concat(a+1));try{await t(g),h([{title:"",description:"",date:"",location:"",call_time:"",call_time_manual:!1,timezone:s,rehearsals:[]}]),(0,d.nr)(n),m(!1),x(null)}catch(e){b(e instanceof Error?e.message:"An error occurred")}};return(0,r.jsxs)("form",{onSubmit:N,className:"space-y-4",children:[p&&(0,r.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:[(0,r.jsxs)("p",{className:"font-semibold",children:["Error: ",p]}),p.includes("supabaseUrl")&&(0,r.jsx)("p",{className:"text-sm mt-2",children:"\uD83D\uDCCC Make sure to configure your .env.local file with Supabase credentials. See QUICK_START.md for instructions."})]}),o&&(0,r.jsxs)("div",{className:"bg-blue-50 border border-blue-200 text-blue-900 px-4 py-2 rounded text-sm",children:["Draft restored from this browser. ",u?"Last saved ".concat(new Date(u).toLocaleString(),"."):""]}),g.map((e,t)=>(0,r.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 bg-white space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("h3",{className:"font-semibold text-gray-900",children:["Performance #",t+1]}),g.length>1&&(0,r.jsx)("button",{type:"button",onClick:()=>{h(e=>e.filter((e,a)=>a!==t))},className:"text-sm text-red-600 hover:text-red-800",children:"Remove"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Performance Title *"}),(0,r.jsx)("input",{type:"text",value:e.title,onChange:e=>y(t,"title",e.target.value),placeholder:"e.g., Spring Recital 2026",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Time *"}),(0,r.jsx)("input",{type:"datetime-local",value:e.date,onChange:e=>y(t,"date",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Call Time"}),(0,r.jsx)("input",{type:"time",value:e.call_time,onChange:e=>y(t,"call_time",e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,r.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"Auto-fills 1 hour before performance unless edited."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Location *"}),(0,r.jsx)(i.e,{value:e.location,onChange:e=>y(t,"location",e),placeholder:"e.g., Main Auditorium",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:["Timezone: ",e.timezone," (times are saved in Eastern Time)"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-gray-700 font-semibold mb-2",children:"Notes"}),(0,r.jsx)("textarea",{value:e.description,onChange:e=>y(t,"description",e.target.value),placeholder:"Add any details about this performance...",rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,r.jsxs)("div",{className:"border-t border-gray-200 pt-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("div",{className:"font-semibold text-gray-900",children:"Rehearsals (optional)"}),(0,r.jsx)("button",{type:"button",onClick:()=>{h(e=>e.map((e,a)=>a===t?{...e,rehearsals:[...e.rehearsals,{title:"",date:"",time:"",location:""}]}:e))},className:"text-xs text-blue-700 hover:text-blue-900",children:"+ Add rehearsal"})]}),0===e.rehearsals.length&&(0,r.jsx)("div",{className:"text-xs text-gray-500",children:"No rehearsals added."}),(0,r.jsx)("div",{className:"space-y-3",children:e.rehearsals.map((e,a)=>(0,r.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-200",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2",children:[(0,r.jsx)("input",{type:"text",value:e.title,onChange:e=>j(t,a,"title",e.target.value),placeholder:"Rehearsal title",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"}),(0,r.jsx)("input",{type:"date",value:e.date,onChange:e=>j(t,a,"date",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"}),(0,r.jsx)("input",{type:"time",value:e.time,onChange:e=>j(t,a,"time",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"}),(0,r.jsx)("input",{type:"text",value:e.location,onChange:e=>j(t,a,"location",e.target.value),placeholder:"Location",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),(0,r.jsx)("button",{type:"button",onClick:()=>{h(e=>e.map((e,r)=>r===t?{...e,rehearsals:e.rehearsals.filter((e,t)=>t!==a)}:e))},className:"mt-2 text-xs text-red-600 hover:text-red-800",children:"Remove rehearsal"})]},"reh-".concat(t,"-").concat(a)))})]})]},"performance-".concat(t))),(0,r.jsx)("button",{type:"button",onClick:()=>{h(e=>[...e,{title:"",description:"",date:"",location:"",call_time:"",call_time_manual:!1,timezone:s,rehearsals:[]}])},className:"w-full px-4 py-2 bg-gray-200 text-gray-900 rounded-lg hover:bg-gray-300 font-medium",children:"+ Add Another Performance"}),(0,r.jsx)("button",{type:"submit",disabled:a,className:"w-full px-6 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 disabled:bg-gray-400 transition-colors",children:a?"Creating...":"Create Performance"})]})}function u(e){let{performances:t,onDelete:a,isLoading:l=!1}=e;return 0===t.length?(0,r.jsxs)("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"No performances created yet."}),(0,r.jsx)("p",{className:"text-gray-500 text-sm",children:"Create your first performance to get started!"})]}):(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{className:"bg-gray-200",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-4 py-2 text-left",children:"Title"}),(0,r.jsx)("th",{className:"px-4 py-2 text-left",children:"Date"}),(0,r.jsx)("th",{className:"px-4 py-2 text-left",children:"Location"}),(0,r.jsx)("th",{className:"px-4 py-2 text-center",children:"Actions"})]})}),(0,r.jsx)("tbody",{children:t.map(e=>(0,r.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-4 py-3 font-semibold",children:e.title}),(0,r.jsx)("td",{className:"px-4 py-3",children:((e,t)=>{if(!e)return"--";let a=new Date(e);return Number.isNaN(a.getTime())?"--":a.toLocaleString(void 0,{timeZone:t||"America/New_York",timeZoneName:"short"})})(e.date,e.timezone)}),(0,r.jsx)("td",{className:"px-4 py-3",children:e.location}),(0,r.jsxs)("td",{className:"px-4 py-3 text-center space-x-2",children:[(0,r.jsx)(n(),{href:"/admin/performances/".concat(e.id),className:"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm",children:"Manage"}),(0,r.jsx)("button",{onClick:()=>{window.confirm("Are you sure you want to delete this performance?")&&a(e.id)},disabled:l,className:"px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 text-sm disabled:bg-gray-400",children:"Delete"})]})]},e.id))})]})})}var x=a(5239);function g(){let[e,t]=(0,l.useState)(!1),[a,s]=(0,l.useState)(null),[n,o]=(0,l.useState)(!1),[i,d]=(0,l.useState)(null),[c,m]=(0,l.useState)(null);(0,l.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/app-logo");if(!e.ok)return;let t=await e.json();d(t.logoUrl||null),m(t.logoFileName||null)}catch(e){}})()},[]);let u=async e=>{var a;let r=null==(a=e.currentTarget.files)?void 0:a[0];if(r){t(!0),s(null),o(!1);try{let t=new FormData;t.append("file",r);let a=await fetch("/api/app-logo",{method:"POST",body:t});if(!a.ok){let e=await a.json();throw Error(e.error||"Upload failed")}let l=await a.json();d(l.logoUrl||null),m(l.logoFileName||null),o(!0),e.currentTarget.value=""}catch(e){s(e instanceof Error?e.message:"Upload failed")}finally{t(!1)}}};return(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[(0,r.jsx)("h3",{className:"font-bold text-lg text-gray-900 mb-4",children:"App Logo"}),i&&(0,r.jsxs)("div",{className:"mb-4 flex items-center gap-4",children:[(0,r.jsx)("div",{className:"w-16 h-16 rounded-lg border border-gray-200 bg-white flex items-center justify-center overflow-hidden",children:(0,r.jsx)(x.default,{src:i,alt:"App logo preview",width:64,height:64,unoptimized:!0,className:"max-w-full max-h-full object-contain"})}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,r.jsx)("div",{className:"font-semibold text-gray-900",children:"Current Logo"}),(0,r.jsx)("div",{children:c||"Uploaded logo"})]})]}),!i&&(0,r.jsx)("div",{className:"mb-4 text-sm text-gray-600",children:"No logo uploaded yet. Upload one to display it across the app and exports."}),(0,r.jsxs)("label",{className:"block",children:[(0,r.jsx)("div",{className:"flex items-center justify-center w-full p-6 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-blue-400 transition-colors bg-gray-50 hover:bg-blue-50",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-2xl mb-2",children:"\uD83D\uDDBC️"}),(0,r.jsx)("p",{className:"text-sm font-semibold text-gray-700",children:e?"Uploading...":"Click to upload logo"}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"PNG, JPG, SVG, WebP (max 5MB)"})]})}),(0,r.jsx)("input",{type:"file",accept:"image/*",onChange:u,disabled:e,className:"hidden"})]}),a&&(0,r.jsx)("div",{className:"mt-3 p-3 bg-red-50 border border-red-200 rounded",children:(0,r.jsxs)("p",{className:"text-sm text-red-900",children:["❌ ",a]})}),n&&(0,r.jsx)("div",{className:"mt-3 p-3 bg-green-50 border border-green-200 rounded",children:(0,r.jsx)("p",{className:"text-sm text-green-900",children:"✅ Logo uploaded successfully!"})})]})}var h=a(1517),p=a(1776),b=a(5959);function f(){let[e,t]=(0,l.useState)("performances"),[a,s]=(0,l.useState)(!1),{performances:i,loading:d,createPerformance:m,deletePerformance:u}=(0,o.f)(),x=async e=>{for(let t of e){let e=await m(t.title,t.description,t.date?(0,c.Xr)(t.date,t.timezone||"America/New_York"):t.date,t.location,t.call_time,t.timezone||"America/New_York");for(let a of(t.rehearsals||[]).filter(e=>e.date&&e.time&&e.location))await fetch("/api/rehearsals",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({performance_id:e.id,title:a.title||"".concat(t.title," Rehearsal"),date:a.date,time:a.time,location:a.location})})}s(!1)};return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,r.jsx)("nav",{className:"bg-blue-900 text-white p-4 shadow-lg",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto flex justify-between items-center",children:[(0,r.jsx)(h.AppBrand,{href:"/"}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)(n(),{href:"/",className:"hover:bg-blue-800 px-3 py-2 rounded",children:"Home"}),(0,r.jsx)("span",{className:"px-3 py-2 bg-blue-800 rounded",children:"Admin Panel"}),(0,r.jsx)(b.$,{className:"px-3 py-2 bg-blue-700 rounded hover:bg-blue-600 text-sm"})]})]})}),(0,r.jsxs)("div",{className:"max-w-7xl mx-auto p-6",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Admin Dashboard"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Manage performances, rehearsals, parts, and stage positioning"})]}),(0,r.jsxs)("div",{className:"flex gap-4 mb-8 flex-wrap",children:[(0,r.jsx)("button",{onClick:()=>t("performances"),className:"px-6 py-3 rounded-lg font-semibold transition-colors ".concat("performances"===e?"bg-blue-600 text-white":"bg-white text-gray-900 hover:bg-gray-50"),children:"Performances"}),(0,r.jsx)("button",{onClick:()=>t("schedule"),className:"px-6 py-3 rounded-lg font-semibold transition-colors ".concat("schedule"===e?"bg-blue-600 text-white":"bg-white text-gray-900 hover:bg-gray-50"),children:"Schedule"}),(0,r.jsx)("button",{onClick:()=>t("branding"),className:"px-6 py-3 rounded-lg font-semibold transition-colors ".concat("branding"===e?"bg-blue-600 text-white":"bg-white text-gray-900 hover:bg-gray-50"),children:"Branding"})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-8",children:["performances"===e&&(0,r.jsx)(y,{performances:i,loading:d,showForm:a,onToggleForm:()=>s(!a),onCreatePerformance:x,onDeletePerformance:u}),"schedule"===e&&(0,r.jsx)(p.z,{title:"Studio Schedule",accent:"blue"}),"branding"===e&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Branding"}),(0,r.jsx)("div",{className:"max-w-md",children:(0,r.jsx)(g,{})})]})]})]})]})}function y(e){let{performances:t,loading:a,showForm:l,onToggleForm:s,onCreatePerformance:n,onDeletePerformance:o}=e;return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold",children:"Performances"}),(0,r.jsx)("button",{onClick:s,className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-semibold",children:l?"Cancel":"+ Create New Performance"})]}),l&&(0,r.jsx)("div",{className:"mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200",children:(0,r.jsx)(m,{onSubmit:n})}),a?(0,r.jsx)("div",{className:"text-center py-12",children:(0,r.jsx)("p",{className:"text-gray-600",children:"Loading performances..."})}):(0,r.jsx)(u,{performances:t,onDelete:o})]})}}},e=>{e.O(0,[5481,2373,2590,8441,1255,7358],()=>e(e.s=7930)),_N_E=e.O()}]);