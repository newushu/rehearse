"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2590],{1517:(e,t,r)=>{r.d(t,{AppBrand:()=>o});var a=r(5155),i=r(2619),n=r.n(i),l=r(6979);function o(e){let{href:t="/",textClassName:r="text-2xl font-bold",logoClassName:i=""}=e,o=(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(l.v,{className:"border border-white/30 bg-white/10 text-white/60 ".concat(i)}),(0,a.jsx)("span",{className:r,children:"Performance Tool"})]});return t?(0,a.jsx)(n(),{href:t,className:"flex items-center gap-3",children:o}):o}},1776:(e,t,r)=>{r.d(t,{z:()=>l});var a=r(5155),i=r(2115),n=r(9157);function l(e){let{title:t="Performance Schedule",accent:r="blue"}=e,{performances:l,rehearsals:o,loading:s,error:c}=function(){let[e,t]=(0,i.useState)([]),[r,a]=(0,i.useState)([]),[n,l]=(0,i.useState)(!0),[o,s]=(0,i.useState)(null);return(0,i.useEffect)(()=>{let e=!0;return async function(){try{let[r,i]=await Promise.all([fetch("/api/performances"),fetch("/api/rehearsals")]);if(!r.ok)throw Error("Failed to fetch performances");if(!i.ok)throw Error("Failed to fetch rehearsals");let n=await r.json(),l=await i.json();if(!e)return;t(n||[]),a(l||[])}catch(t){if(!e)return;s(t instanceof Error?t.message:"Failed to load schedule")}finally{e&&l(!1)}}(),()=>{e=!1}},[]),{performances:e,rehearsals:r,loading:n,error:o}}(),[d,m]=(0,i.useState)("list"),[u,f]=(0,i.useState)(()=>new Date),[h,g]=(0,i.useState)(""),[p,x]=(0,i.useState)(""),[y,b]=(0,i.useState)({}),[N,w]=(0,i.useState)(null),[v,j]=(0,i.useState)(!1),T=(0,i.useMemo)(()=>{let e=new Map;for(let t of l)e.set(t.id,{title:t.title,timezone:n.GI});return[...l.map(e=>{let t=n.GI,r=(0,n.so)(e.date,t);return{id:e.id,type:"performance",dateKey:r,title:e.title,timeLabel:(0,n.Z5)(e.date,t),sortTime:new Date(e.date).getTime(),location:e.location,performanceId:e.id,timezone:t,isoDate:e.date}}),...o.map(t=>{let r=new Date((0,n.Xr)("".concat(t.date,"T").concat(t.time),n.GI)||"".concat(t.date,"T").concat(t.time)),a=e.get(t.performance_id),i=(null==a?void 0:a.timezone)||n.GI;return{id:t.id,type:"rehearsal",dateKey:t.date,title:t.title,timeLabel:(0,n.a7)(t.time),sortTime:Number.isNaN(r.getTime())?0:r.getTime(),location:t.location,performanceTitle:null==a?void 0:a.title,performanceId:t.performance_id,timezone:i}})].sort((e,t)=>e.dateKey===t.dateKey?e.sortTime-t.sortTime:e.dateKey.localeCompare(t.dateKey))},[l,o]),S=(0,i.useMemo)(()=>{let e=h.trim().toLowerCase(),t=p.trim().toLowerCase();return T.filter(r=>{if(e&&!"".concat(r.title," ").concat(r.performanceTitle||"").toLowerCase().includes(e))return!1;if(t){let e=r.performanceId;if(!e||!(y[e]||[]).some(e=>e.toLowerCase().includes(t)))return!1}return!0})},[T,h,p,y]),D=(0,n.so)(new Date().toISOString(),n.GI),C=(0,i.useMemo)(()=>{let e={};for(let t of S)e[t.dateKey]=e[t.dateKey]||[],e[t.dateKey].push(t);return e},[S]);(0,i.useEffect)(()=>{if(!p.trim())return;let e=l.filter(e=>!y[e.id]);if(0===e.length)return;let t=!0;return(async()=>{let r=await Promise.all(e.map(async e=>{try{let t=await fetch("/api/performances/".concat(e.id,"/roster"));if(!t.ok)return[e.id,[]];let r=(await t.json()||[]).map(e=>e.name||"Unknown");return[e.id,r]}catch(t){return[e.id,[]]}}));t&&b(e=>{let t={...e};return r.forEach(e=>{let[r,a]=e;t[r]=a}),t})})(),()=>{t=!1}},[p,l,y]),(0,i.useEffect)(()=>{let e=window.matchMedia("(max-width: 768px)"),t=()=>j(e.matches);return t(),e.addEventListener("change",t),()=>e.removeEventListener("change",t)},[]),(0,i.useEffect)(()=>{v&&"calendar"===d&&m("list")},[v,d]);let k="green"===r?{active:"bg-green-600 text-white",pill:"bg-green-100 text-green-800"}:{active:"bg-blue-600 text-white",pill:"bg-blue-100 text-blue-800"},L=(0,i.useMemo)(()=>[{reh:"bg-blue-600 text-white",perf:"bg-blue-600 text-white"},{reh:"bg-emerald-600 text-white",perf:"bg-emerald-600 text-white"},{reh:"bg-rose-600 text-white",perf:"bg-rose-600 text-white"},{reh:"bg-amber-600 text-white",perf:"bg-amber-600 text-white"},{reh:"bg-indigo-600 text-white",perf:"bg-indigo-600 text-white"},{reh:"bg-teal-600 text-white",perf:"bg-teal-600 text-white"}],[]),E=(0,i.useMemo)(()=>{let e={};return l.forEach((t,r)=>{e[t.id]=L[r%L.length]}),e},[l,L]),F=e=>{let t=e.performanceId?E[e.performanceId]:null;return t?"performance"===e.type?t.perf:t.reh:k.pill},U=e=>"performance"===e.type?"Perf":"Reh",I=e=>{if("rehearsal"===e.type){let t=e.performanceTitle||"Performance";return"Reh: ".concat(e.timeLabel," - ").concat(t)}return"Perf: ".concat(e.timeLabel," - ").concat(e.title)},P=e=>{let t=K(e),r="rehearsal"===e.type&&e.performanceTitle?"For: ".concat(e.performanceTitle):"";return[e.title,r,"When: ".concat(t),e.location?"Where: ".concat(e.location):""].filter(Boolean).join("\n")},K=e=>{if("performance"===e.type&&e.timezone)return(0,n.P9)(e.isoDate||"",e.timezone);if(e.timezone){var t,r;return"".concat(e.timeLabel," (").concat((t=e.timezone)?t===n.GI?"ET":(null==(r=new Intl.DateTimeFormat("en-US",{timeZone:t,timeZoneName:"short"}).formatToParts(new Date).find(e=>"timeZoneName"===e.type))?void 0:r.value)||t:"",")")}return e.timeLabel},Z=u.toLocaleString(void 0,{month:"long",year:"numeric"});(0,i.useMemo)(()=>{let e=new Map;for(let t of S)e.has(t.dateKey)||e.set(t.dateKey,[]),e.get(t.dateKey).push(t);return e},[S]);let M=(0,i.useMemo)(()=>{let e=new Map;for(let t of S)t.dateKey<D||(e.has(t.dateKey)||e.set(t.dateKey,[]),e.get(t.dateKey).push(t));return e},[S,D]),z=u.getFullYear(),A=u.getMonth(),G=new Date(z,A,1),_=new Date(z,A+1,0).getDate(),W=G.getDay();return s?(0,a.jsx)("div",{className:"text-center py-12 text-gray-600",children:"Loading schedule..."}):c?(0,a.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:c}):(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3 mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:t}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Performances and rehearsals, day by day."}),v&&(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Tip: Rotate your phone for a better calendar view."})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2 items-center",children:[(0,a.jsx)("input",{value:h,onChange:e=>g(e.target.value),placeholder:"Filter by performance",className:"px-3 py-2 border border-gray-200 rounded-lg text-sm"}),(0,a.jsx)("input",{value:p,onChange:e=>x(e.target.value),placeholder:"Filter by student",className:"px-3 py-2 border border-gray-200 rounded-lg text-sm"}),(0,a.jsx)("button",{onClick:()=>m("list"),className:"px-4 py-2 rounded-lg font-semibold ".concat("list"===d?k.active:"bg-white text-gray-700 border border-gray-200"),children:"List"}),!v&&(0,a.jsx)("button",{onClick:()=>m("calendar"),className:"px-4 py-2 rounded-lg font-semibold ".concat("calendar"===d?k.active:"bg-white text-gray-700 border border-gray-200"),children:"Calendar"})]})]}),"list"===d&&(0,a.jsxs)("div",{className:"space-y-6",children:[[...M.keys()].map(e=>(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 ".concat(e<D?"bg-gray-100 text-gray-500":"bg-gray-50"),children:[(0,a.jsx)("div",{className:"mb-3",children:(0,a.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold bg-gray-900 text-white",children:(e=>{let[t,r,a]=e.split("-").map(e=>parseInt(e,10));return t&&r&&a?new Date(Date.UTC(t,r-1,a,12,0,0)).toLocaleDateString(void 0,{timeZone:n.GI,weekday:"long",month:"short",day:"numeric",year:"numeric"}):e})(e)})}),(0,a.jsx)("div",{className:"space-y-2",children:M.get(e).map(e=>(0,a.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3 bg-white border border-gray-200 rounded-lg px-4 py-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"font-semibold text-gray-900",children:[e.title,"rehearsal"===e.type&&e.performanceTitle&&(0,a.jsxs)("span",{className:"text-xs text-gray-500 ml-2",children:["(for ",e.performanceTitle,")"]})]}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:e.location})]}),(0,a.jsxs)("div",{className:"text-sm font-semibold text-gray-700 flex items-center gap-2 min-w-0",children:[(0,a.jsx)("button",{type:"button",onClick:()=>w(e),className:"px-3 py-1 rounded-full text-[clamp(10px,1.6vw,12px)] leading-tight font-semibold max-w-full ".concat(F(e)),title:P(e),children:I(e)}),(0,a.jsx)("span",{children:K(e)})]})]},e.id))})]},e)),0===M.size&&(0,a.jsx)("div",{className:"text-center py-12 text-gray-500",children:"No scheduled items yet."}),N&&(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-xs uppercase tracking-wide text-gray-500",children:[U(N)," Details"]}),(0,a.jsx)("div",{className:"text-lg font-semibold text-gray-900",children:N.title}),"rehearsal"===N.type&&N.performanceTitle&&(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["for ",N.performanceTitle]})]}),(0,a.jsx)("button",{type:"button",onClick:()=>w(null),className:"text-xs text-gray-500 hover:text-gray-700",children:"Close"})]}),(0,a.jsxs)("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-2 gap-2 text-sm text-gray-700",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-semibold",children:"When:"})," ",K(N)]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-semibold",children:"Location:"})," ",N.location||"—"]})]})]})]}),"calendar"===d&&!v&&(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("button",{onClick:()=>f(new Date(z,A-1,1)),className:"px-3 py-1 rounded border border-gray-200 text-gray-600",children:"Prev"}),(0,a.jsx)("div",{className:"text-lg font-semibold text-gray-900",children:Z}),(0,a.jsx)("button",{onClick:()=>f(new Date(z,A+1,1)),className:"px-3 py-1 rounded border border-gray-200 text-gray-600",children:"Next"})]}),(0,a.jsx)("div",{className:"grid grid-cols-7 text-xs font-semibold text-gray-500 mb-2",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>(0,a.jsx)("div",{className:"text-center py-2",children:e},e))}),(0,a.jsxs)("div",{className:"grid grid-cols-7 gap-2",children:[Array.from({length:W}).map((e,t)=>(0,a.jsx)("div",{},"empty-".concat(t))),Array.from({length:_}).map((e,t)=>{let r=t+1,i="".concat(z,"-").concat(String(A+1).padStart(2,"0"),"-").concat(String(r).padStart(2,"0")),n=C[i]||[],l=i<D;return(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-2 ".concat(l?"bg-gray-50 text-gray-400":""),children:[(0,a.jsx)("div",{className:"text-xs font-semibold text-gray-700 mb-1",children:r}),(0,a.jsx)("div",{className:"space-y-1",children:n.map(e=>(0,a.jsx)("button",{type:"button",className:"w-full text-left px-2 py-1 rounded-full text-[clamp(9px,1.6vw,11px)] leading-tight font-semibold whitespace-normal break-words ".concat((e=>{let t=F(e);return"performance"===e.type?"".concat(t," ring-2 ring-black ring-offset-2 ring-offset-gray-100"):t})(e)),title:P(e),onClick:()=>w(e),children:I(e)},e.id))})]},i)})]}),N&&(0,a.jsxs)("div",{className:"mt-4 bg-white border border-gray-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-xs uppercase tracking-wide text-gray-500",children:[U(N)," Details"]}),(0,a.jsx)("div",{className:"text-lg font-semibold text-gray-900",children:N.title}),"rehearsal"===N.type&&N.performanceTitle&&(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["for ",N.performanceTitle]})]}),(0,a.jsx)("button",{type:"button",onClick:()=>w(null),className:"text-xs text-gray-500 hover:text-gray-700",children:"Close"})]}),(0,a.jsxs)("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-2 gap-2 text-sm text-gray-700",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-semibold",children:"When:"})," ",K(N)]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-semibold",children:"Location:"})," ",N.location||"—"]})]})]})]})]})}},6979:(e,t,r)=>{r.d(t,{v:()=>l});var a=r(5155),i=r(5239),n=r(2115);function l(e){let{size:t=36,className:r="",imgClassName:l=""}=e,[o,s]=(0,n.useState)(null);return(0,n.useEffect)(()=>{let e=!0;return(async()=>{try{let t=await fetch("/api/app-logo");if(!t.ok)return;let r=await t.json();e&&s(r.logoUrl||null)}catch(e){}})(),()=>{e=!1}},[]),(0,a.jsx)("div",{className:"flex items-center justify-center overflow-hidden ".concat(r),style:{width:t,height:t,borderRadius:8},children:o?(0,a.jsx)(i.default,{src:o,alt:"App logo",width:t,height:t,unoptimized:!0,className:"max-w-full max-h-full object-contain ".concat(l)}):(0,a.jsx)("span",{className:"text-[10px] font-semibold uppercase tracking-wide",children:"Logo"})})}},9157:(e,t,r)=>{r.d(t,{$H:()=>d,GI:()=>a,Kb:()=>h,P9:()=>c,Xr:()=>o,Z5:()=>m,a7:()=>f,eL:()=>g,so:()=>u,y7:()=>s});let a="America/New_York",i=e=>/[zZ]|[+-]\d{2}:\d{2}$/.test(e),n=e=>{if(!e)return null;let[t,r]=e.split(/[T ]/);if(!t||!r)return null;let a=r.slice(0,5),[i,n,l]=t.split("-"),[o,s]=a.split(":"),c=Number(i),d=Number(n),m=Number(l),u=Number(o),f=Number(s);return Number.isFinite(c)&&Number.isFinite(d)&&Number.isFinite(m)&&Number.isFinite(u)&&Number.isFinite(f)?{datePart:t,timePart:a,year:c,month:d,day:m,hour:u,minute:f}:null};function l(e){if(!e)return null;let[t,r]=e.split("T");if(!t||!r)return null;let[a,i,n]=t.split("-"),[l,o]=r.split(":"),s=Number(a),c=Number(i),d=Number(n),m=Number(l),u=Number(o);return Number.isFinite(s)&&Number.isFinite(c)&&Number.isFinite(d)&&Number.isFinite(m)&&Number.isFinite(u)?{year:s,month:c,day:d,hour:m,minute:u}:null}function o(e,t){let r=l(e);if(!r)return"";let a=new Date(Date.UTC(r.year,r.month-1,r.day,r.hour,r.minute,0)),i=function(e,t){let r=new Intl.DateTimeFormat("en-US",{timeZone:e,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).formatToParts(t),a={};for(let e of r)"literal"!==e.type&&(a[e.type]=e.value);return Date.UTC(Number(a.year),Number(a.month)-1,Number(a.day),Number(a.hour),Number(a.minute),Number(a.second))-t.getTime()}(t,a);return new Date(a.getTime()-i).toISOString()}function s(e,t){if(!e)return"";if(!i(e)){let t=n(e);return t?"".concat(t.datePart,"T").concat(t.timePart):e}let r=new Date(e);if(Number.isNaN(r.getTime()))return"";let a=new Intl.DateTimeFormat("en-US",{timeZone:t,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1}).formatToParts(r),l={};for(let e of a)"literal"!==e.type&&(l[e.type]=e.value);return"".concat(l.year,"-").concat(l.month,"-").concat(l.day,"T").concat(l.hour,":").concat(l.minute)}function c(e,t){if(!e)return"—";if(!i(e)){let t=n(e);if(!t)return e;let r=new Date(Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,0)),a=r.toLocaleDateString(void 0,{timeZone:"UTC"}),i=r.toLocaleTimeString(void 0,{timeZone:"UTC",hour:"numeric",minute:"2-digit"});return"".concat(a,", ").concat(i," ET")}let r=new Date(e);return Number.isNaN(r.getTime())?"—":r.toLocaleString(void 0,{timeZone:t||a,timeZoneName:"short"})}function d(e,t){if(!e)return"\xe2€”";if(!i(e)){let t=n(e);if(!t)return e;let r=new Date(Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,0)).toLocaleString(void 0,{timeZone:"UTC",weekday:"long",year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"});return"".concat(r," ET")}let r=new Date(e);return Number.isNaN(r.getTime())?"\xe2€”":r.toLocaleString(void 0,{timeZone:t||a,weekday:"long",year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",timeZoneName:"short"})}function m(e,t){if(!e)return"—";if(!i(e)){let t=n(e);return t?f(t.timePart):e}let r=new Date(e);return Number.isNaN(r.getTime())?"—":r.toLocaleTimeString(void 0,{timeZone:t||a,hour:"numeric",minute:"2-digit"})}function u(e,t){if(!e)return"";if(!i(e)){let t=n(e);return t?t.datePart:""}let r=new Date(e);if(Number.isNaN(r.getTime()))return"";let l=new Intl.DateTimeFormat("en-US",{timeZone:t||a,year:"numeric",month:"2-digit",day:"2-digit"}).formatToParts(r),o={};for(let e of l)"literal"!==e.type&&(o[e.type]=e.value);return"".concat(o.year,"-").concat(o.month,"-").concat(o.day)}function f(e){if(!e)return"—";let[t,r]=e.split(":"),a=Number(t),i=Number(r);return Number.isFinite(a)&&Number.isFinite(i)?new Date(Date.UTC(2e3,0,1,a,i,0)).toLocaleTimeString(void 0,{hour:"numeric",minute:"2-digit",timeZone:"UTC"}):e}function h(e){let t=l(e);if(!t)return"";let r=new Date(Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,0));r.setUTCHours(r.getUTCHours()-1);let a=String(r.getUTCHours()).padStart(2,"0"),i=String(r.getUTCMinutes()).padStart(2,"0");return"".concat(a,":").concat(i)}function g(e,t){if(!e)return!1;let r=new Date(o(e,t));if(Number.isNaN(r.getTime()))return!1;let a=r.getTime()-36e5;return Date.now()>=a}},9815:(e,t,r)=>{r.d(t,{f:()=>i});var a=r(2115);function i(){let[e,t]=(0,a.useState)([]),[r,i]=(0,a.useState)(!0),[n,l]=(0,a.useState)(null);(0,a.useEffect)(()=>{!async function(){try{let e=await fetch("/api/performances");if(!e.ok)throw Error("Failed to fetch performances");let r=await e.json();t(r)}catch(e){l(e instanceof Error?e.message:"An error occurred")}finally{i(!1)}}()},[]);let o=async(r,a,i,n,o,s)=>{try{let l=await fetch("/api/performances",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:r,description:a,date:i,location:n,call_time:o,timezone:s})});if(!l.ok)throw Error("Failed to create performance");let c=await l.json();return t([...e,c]),c}catch(e){throw l(e instanceof Error?e.message:"An error occurred"),e}},s=async r=>{try{if(!(await fetch("/api/performances/".concat(r),{method:"DELETE"})).ok)throw Error("Failed to delete performance");t(e.filter(e=>e.id!==r))}catch(e){throw l(e instanceof Error?e.message:"An error occurred"),e}};return{performances:e,loading:r,error:n,createPerformance:o,deletePerformance:s}}}}]);